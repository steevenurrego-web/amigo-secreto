<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Lista de Regalos ğŸ</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  padding: 20px;
}

h1 {
  text-align: center;
}

.contenedor {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 30px;
}

.tarjeta {
  background: white;
  border-radius: 12px;
  padding: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.tarjeta h3 {
  margin-top: 0;
}

.regalo {
  margin-bottom: 10px;
}

.regalo img {
  width: 100%;
  border-radius: 8px;
  margin-top: 5px;
}
</style>
</head>

<body>

<h1>ğŸ„ Lista de Regalos ğŸ</h1>

<div class="contenedor" id="lista"></div>
<script>
function convertirURL(url) {
  if (!url) return "";

  // Limpia comillas
  url = url.replace(/"/g, "").trim();

  // Extrae el ID del archivo
  const match = url.match(/id=([^&]+)/);
  if (!match) return "";

  return `https://drive.google.com/uc?export=view&id=${match[1]}`;
}
</script>
<script>
const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTzdoV5UmpvNQh1tKzAVaLh4MHeW82imqI-fciCiZdCOE4qc5u1bLhQoVUZRqKIfAuoUUiP-AADuxQq/pub?gid=872944158&single=true&output=csv";

fetch(url)
  .then(res => res.text())
  .then(data => {
    const filas = data.split("\n").slice(1);
    const contenedor = document.getElementById("lista");

    filas.forEach(fila => {
      const cols = fila.split(",");

      if (!cols[1]) return;

      let html = `<div class="tarjeta">
        <h3>${cols[1]}</h3>`;

      for (let i = 2; i <= 10; i += 2) {
        if (cols[i]) {
          html += `
            <div class="regalo">
              ğŸ ${cols[i]}
              ${cols[i+1] ? `<img src="${convertirURL(cols[i+1])}" />` : ""}
            </div>`;
        }
      }

      html += `</div>`;
      contenedor.innerHTML += html;
    });
  });
</script>

</body>  
</html>
