<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Lista de Regalos ğŸ</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  padding: 20px;
}

h1 {
  text-align: center;
}

.contenedor {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 30px;
}

.tarjeta {
  background: white;
  border-radius: 12px;
  padding: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.tarjeta h3 {
  margin-top: 0;
}

.regalo {
  margin-bottom: 10px;
}

.regalo img {
  width: 100%;
  border-radius: 8px;
  margin-top: 5px;
}
</style>
</head>

<body>

<h1>ğŸ„ Lista de Regalos ğŸ</h1>

<div class="contenedor" id="lista"></div>
<script>
const sheetID = "1nfyh_rqYNYdGUbfIIpVQIAoLM77-OsRhVhoaCou_Oh8";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

fetch(url)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substring(47).slice(0, -2));
    const filas = json.table.rows;
    const contenedor = document.getElementById("lista");

    filas.forEach(row => {
      const c = row.c;
      if (!c[1]) return;

      let html = `<div class="tarjeta"><h3>${c[1].v}</h3>`;

      for (let i = 2; i <= 10; i += 2) {
        if (c[i] && c[i].v) {
          html += `
            <div class="regalo">
              ğŸ ${c[i].v}
              ${c[i+1] && c[i+1].v
                ? `<img src="${convertirURL(c[i+1].v)}">`
                : ""}
            </div>`;
        }
      }

      html += `</div>`;
      contenedor.innerHTML += html;
    });
  });

function convertirURL(url) {
  const match = url.match(/id=([^&]+)/);
  return match
    ? `https://drive.google.com/uc?export=view&id=${match[1]}`
    : "";
}
</script>

</body>  
</html>
